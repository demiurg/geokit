{% extends "wagtailadmin/base.html" %}

{% block titletag %}Variables{% endblock %}
{% block bodyclass %}menu-variables{% endblock %}

{% block extra_css %}
<style>
.raster-status.done {
  color: #148744;
}

.raster-status.working {
  color: #b7a500;
}

.raster-status.bad {
  color: #840d00;
}
</style>
{% endblock %}

{% block content %}
{% include "wagtailadmin/shared/header.html" with title="Variables" icon="placeholder" add_link="variables:add" add_text="Create Variable" %}

<div class="nice-padding">
  <div id="variables-results" class="variables">
    {% if variables_and_statuses %}
    <table class="listing">
      <col />
      <col />
      <col />
      <col />
      <col />
      <thead>
        <tr class="table-headers">
          <th>Name</th>
          <th>Description</th>
          <th>Dimensions</th>
          <th>Bounds</th>
          <th>Last Modified</th>
          <th>Inputs</th>
        </tr>
      </thead>
      <tbody>
        {% for variable, statuses in variables_and_statuses %}
        <tr>
          <td class="title">
            <a href="{% url 'variables:edit' variable.pk %}">
              {{ variable.name }}
            </a>
          </td>
          <td class="description">
            {{ variable.description }}
          </td>
          <td class="spatial_domain">
            {{ variable.saved_dimensions }}
          </td>
          <td class='bounds'>
            {{ variable.bounds }}
          </td>
          <td>
            {{ variable.modified }}
          </td>
          <td>
            <dl>
              {% if statuses %}
              <dt>Rasters</dt>
              <dd>
                {% for raster, status in statuses.iteritems %}
                <span class="raster-status {% if status == 'complete' %}done{% elif status == 'failed' %}bad{% else %}working{% endif %}">
                  {% if forloop.first %}
                    {{ raster }} (<em>{{ status }}</em>)
                  {% else %}
                    , {{ raster }} (<em>{{ status }}</em>)
                  {% endif %}
                </span>
                {% endfor %}
              </dd>
              {% endif %}
              {% if variable.layers %}
              <dt>Layers</dt>
              <dd>
                {% for layer in variable.layers %}
                  {% if forloop.first %}
                    {{ layer.name }}
                  {% else %}
                    , {{ layer.name }}
                  {% endif %}
                {% endfor %}
              </dd>
              {% endif %}
              {% if variable.tables %}
              <dt>Tables</dt>
              <dd>
                {% for table in variable.tables %}
                  {% if forloop.first %}
                    {{ table.name }}
                  {% else %}
                    {{ table.name }}
                  {% endif %}
                {% endfor %}
              </dd>
              {% endif %}
            </dl>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p>You haven't created any variables yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
